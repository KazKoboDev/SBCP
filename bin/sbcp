#!/usr/bin/env ruby

# SBCP - Starbound Server Management Solution for Linux Servers
# Copyright (C) 2016-2017 Kobold Software (Kazyyk)

# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.

# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

require 'optparse'

require_relative '../lib/sbcp/version'

o = OptionParser.new do |opts|
	opts.banner = 'Usage: sbcp [flag]'
	opts.on('-s', '--start', 'Starts the SBCP web server') do
		exec("ruby -e \'require \"./lib/sbcp.rb\"; SBCP::WebServer.new.start\'")
		#exec("ruby -e \'@dir = Gem::Specification.find_by_name(\"sbcp\").gem_dir; require @dir + \"/lib/sbcp.rb\"; SBCP::WebServer.new.start\'")
	end
	opts.on('-r', '--restart', 'Kills the SBCP process and starts it anew') do
		# TODO
	end
	opts.on('-k', '--kill', 'Stops the SBCP web server') do
		# TODO
	end
	opts.on_tail('-v', '--version', 'Displays the current SBCP version') do
		puts SBCP::VERSION
	end
	opts.on_tail('-h', '--help', 'Shows this menu') do
		puts opts
		exit
	end
end

ARGV << '-h' if ARGV.empty? # Displays help if no arguements given.
begin o.parse!
rescue OptionParser::MissingArgument => e
	puts e
	exit 1
rescue OptionParser::InvalidArgument => e
	puts e
	exit 1
rescue OptionParser::InvalidOption => e
	puts e
	puts o 
	exit 1
end